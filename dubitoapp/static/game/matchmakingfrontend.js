const ws_scheme="https:"==window.location.protocol?"wss":"ws",socket=new WebSocket(ws_scheme+"://"+window.location.host+"/ws/matchmaking/");let vue=new Vue({el:"#app",delimiters:["${","}"],components:{},data:{socket:void 0,player_name:"",timer:10,timer_started:!1,game_id:void 0,player_found:!1,searching:!1,ellipsis:"&nbsp;&nbsp;&nbsp;",matchmaking_errors:[],handle:null,online_players:!1},mounted(){const e=this;socket.onmessage=function(t){switch(data=JSON.parse(t.data),data.type){case"player_found":e.game_id=data.game_id,e.timer_started||(e.player_found=!0,e.trigger_timer());break;case"reset_timer":e.game_id=null,e.player_found=!1,clearInterval(e.handle),this.handle=null,e.timer=10,e.timer_started=!1;break;case"online_players":e.online_players=data.value}}},created(){},watch:{},methods:{enter_matchmaking(){this.matchmaking_errors=[],this.player_name.length?/^[a-z0-9]+$/i.test(this.player_name)?(socket.send(JSON.stringify({type:"join_matchmaking",player_name:this.player_name})),this.searching=!0,this.animateEllipsis()):this.matchmaking_errors.push(window.gettext("Il tuo nome contiene caratteri non consentiti.")):this.matchmaking_errors.push(window.gettext("Campo richiesto."))},trigger_timer(){this.timer_started=!0,this.handle=setInterval(()=>{this.timer--,this.timer||(window.location.href="/game/game/"+this.game_id)},1e3)},animateEllipsis(){let e=0;setInterval(()=>{this.ellipsis=this.stringTimes(".",e++%4,3)},400)},stringTimes(e,t,i){let s="";for(let i=0;i<t;i++)s+=e;for(let e=t;e<i;e++)s+="&nbsp;";return s}},computed:{seconds(){return 1!=this.timer?window.gettext("secondi"):window.gettext("secondo")}}});